<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hochzeit von Lisa & Paul</title>
    <link rel="stylesheet" href="style.css"></link>

    <meta http-equiv="ScreenOrientation" content="autoRotate:disabled">

    <link rel="icon" type="image/png" href="Resources/FG-Icon.png">
  </head>



  <body onresize="ResizeFunction()" onload="ResizeFunction()" width="100%">
    <div class="TitlePicture"><img width="100%" id="DesktopTitlePictureImg" src="Resources/TitlePic.png"></div>
    
    <table width="100%" border="0">
      <tr width="100%">
        <td width="100%" colspan="3" height="150px">
        </td>
      </tr>
      <tr width="100%">
        <td width="20%">

        </td>
        <td width="60%">
          <div class="MainOverlayText">Hochzeit von Lisa & Paul</div>
          <div class="Spacer10"></div>
          <div class="Spacer10"></div>
          <div class="H1OverlayText">23.05.2026</div>
          <div class="Spacer10"></div>
          <div class="Spacer10"></div>
          <div class="StdOverlayText">Wir freuen uns riesig, dass ihr an unserem großen Tag dabei seid.
Hier findet ihr alle wichtigen Infos
Damit ihr entspannt planen könnt und am Hochzeitstag einfach nur genießen müsst ✨</div>
          <div class="Spacer10"></div>
          <div class="Spacer10"></div>
          <div class="H2OverlayText">Zeitplan:</div>
                    <div class="Spacer10"></div>
          <div width="80%">
            <table class="TimeTable" id="TimeTable" width="100%">
            <tr width="100%" height="40px" class="StdTableText">
              <td width="10%" height="40px">
                
              </td>
              <td width="15%" style="border-bottom: 1px solid #aa5432;">
                10:00
              </td>
              <td width="40%" height="40px" style="border-bottom: 1px solid #aa5432;">
                Treffen
              </td>
              <td width="25%" height="40px" style="border-bottom: 1px solid #aa5432;">
                <a href="https://maps.app.goo.gl/XKyiZarh3x42NhnE9" target="_blank" class="StdLink">Wasserturm Hockenheim</a>
              </td>
              <td width="10%">

              </td>
            </tr>
            <tr width="100%" height="40px" class="StdTableText">
              <td width="10%" height="40px">
                
              </td>
              <td width="15%" style="border-bottom: 1px solid #aa5432;">
                19:00
              </td>
              <td width="40%" height="40px" style="border-bottom: 1px solid #aa5432;">
                Abendessen
              </td>
              <td width="25%" height="40px" style="border-bottom: 1px solid #aa5432;">
                <a href="https://maps.app.goo.gl/8ffkyS9kFSbDKyBSA" target="_blank" class="StdLink">Rossini Bensheim</a>
              </td>
              <td width="10%">

              </td>
            </tr>
          </table>

          <div class="Spacer10"></div>
          <div class="Spacer10"></div>
          <div class="Spacer10"></div>
          <div class="Spacer10"></div>

          <div class="StdOverlayText">Bitte sagt uns im Folgenden zu oder ab:</div>
          <div class="Spacer10"></div>
          <form id="rsvpForm">
  <label>
    <input type="checkbox" class="StdCheckBox" name="standesamt" value="Ja">
    Ich komme zur standesamtlichen Hochzeit
  </label><br>
  <div class="Spacer10"></div>

  <label>
    <input type="checkbox" class="StdCheckBox" name="kaffee" value="Ja">
    Ich komme zu Kaffee & Kuchen
  </label><br>
  <div class="Spacer10"></div>

  <label>
    <input type="checkbox" class="StdCheckBox" name="abendessen" value="Ja">
    Ich komme zum Abendessen (bitte nicht kommen, wird sonst zu teuer)
  </label><br>
  <div class="Spacer10"></div>

  <label>
    Name:
    <input type="text" class="StdTextBox" name="name" placeholder="Dein Name" required>
  </label><br>
  <div class="Spacer10"></div>

  <button class="StdButton" type="button" title="Absenden" onclick="sendForm()">
    Absenden
  </button><br>
  <div class="Spacer10"></div>
</form>

        </td>
        <td width="20%">
          
        </td>
      </tr>
    </table>
    
    
  </body>
</html>

  <script>
  // HIER deine Web-App URL aus Google Apps Script eintragen
  const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbwXBNCqZ535Z1pOjio4R2db6xfArxtwfDmyoWZMDamKIPCIBat5GxgIci_mA-wgvOY/exec";

  function sendForm() {
    const form = document.getElementById('rsvpForm');
    const formData = new FormData(form);

    // Checkboxen, die nicht angehakt sind, explizit auf "Nein" setzen
    ["standesamt", "kaffee", "abendessen"].forEach(name => {
      if (!formData.has(name)) {
        formData.append(name, "Nein");
      }
    });

    fetch(WEBAPP_URL, {
      method: "POST",
      body: formData
    })
    .then(res => res.text())
    .then(text => {
      console.log("Antwort vom Server:", text);
      alert("Vielen Dank für deine Rückmeldung! ❤️");
      form.reset();
    })
    .catch(err => {
      console.error("Fehler beim Senden:", err);
      alert("Da ist etwas schiefgelaufen. Bitte später nochmal versuchen.");
    });
  }
</script>